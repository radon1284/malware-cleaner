#!/bin/bash
# Author name: Ruel Nopal
# Company: RaketHost PH Inc.
# url: www.rakethost.ph

# Find the malware files and list it
echo 'Enter search term eg:(kdzooma)'
read search_term
grep -lr '#{search_term}' * >> list.txt

#Malware and remove
LIST=list.txt
INF='#{search_term}'
 
if [ ! -s $LIST ] ; then
grep -l -R --include=*.php $INF * > $LIST
fi
 
for INPUT in `cat $LIST`
do
echo FIX $INPUT ...
TEMP=$INPUT.tmp
OLD=$INPUT.bad
< $INPUT sed "s/<?php/\n<?php/g" | grep -v $INF > $TEMP
mv $INPUT $OLD
mv $TEMP $INPUT
done
